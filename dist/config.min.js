let localConfig={colors:{accent:"#8449d9",dark:"#0E1B2A",bgLight:"#F8FAFC"},meta:{title:"",description:""},header:{logo:"",companyName:"Ton Logo ou nom de l'entreprise",useTextOnly:!1},hero:{title:"Ton titre principal",desc:"Explique en une phrase ce que tu fais, pour qui, et le bénéfice principal. Simple, concret, sans jargon technique. Si on ne comprend pas en 5 secondes, simplifie.",ctaLabel:"Voir nos services",img:"",showFigures:!0,figures:[{num:"150+",label:"PROJETS RÉALISÉS"},{num:"10",label:"ANNÉES d'EXPERTISE"},{num:"99%",label:"CLIENTS SATISFAITS"}]},services:{title:"Nos solutions",items:[{h3:"Service 1",p:"Présente ici un service clé ou un bénéfice majeur. Explique ce que tu fais, pour qui, et ce que ça change pour ton client.",price:"",prefix:"",showPrice:!0,showPrefix:!0},{h3:"Service 2",p:"Présente ici un service clé ou un bénéfice majeur. Explique ce que tu fais, pour qui, et ce que ça change pour ton client.",price:"",prefix:"",showPrice:!0,showPrefix:!0},{h3:"Service 3",p:"Présente ici un service clé ou un bénéfice majeur. Explique ce que tu fais, pour qui, et ce que ça change pour ton client.",price:"",prefix:"",showPrice:!0,showPrefix:!0}]},testimonials:{show:!0,title:"Ce que nos clients disent",ctaText:"Et si vous étiez le prochain ?",items:[{stars:"5",text:"Copie ici une phrase réelle d’un client (avis Google, message, email…). Idéalement : le problème qu’il avait + ce que ton service lui a apporté. Court et authentique.",name:"Prénom du client",role:"Métier / activité"},{stars:"5",text:"Avant de travailler avec [ton activité], je [problème ou situation]. Aujourd’hui, je [résultat ou bénéfice concret].",name:"Prénom",role:"Statut ou secteur"},{stars:"5",text:"Ce que j’ai le plus apprécié : [point fort de ton accompagnement ou de ta prestation]. Je recommande à [type de client].",name:"Prénom",role:"Métier / entreprise"}]},gallery:{title:"Des résultats concrets",images:[{src:"",cap:"Témoignage client : [Prénom], [métier/statut] : ‘[Phrase courte sur ce qu’ils ont aimé ou le résultat]"},{src:"",cap:"Projet / réalisation : [Nom du projet] pour [client/secteur] – [bénéfice principal ou usage]"},{src:"",cap:"Bénéfice / avant‑après : [Produit/service réalisé] – aide [client/secteur] à [résultat principal]"}]},about:{title:"Qui sommes nous",desc:"Racontez en quelques phrases qui vous êtes et ce que vous faites. Vous pouvez : vous présenter individuellement (votre rôle, votre approche, vos forces) ; présenter votre équipe (qui fait quoi, vos expertises) ; ou expliquer votre concept / votre société (mission, valeur ajoutée, bénéfices pour vos clients). Soyez clair, simple et engageant : l’objectif est que quelqu’un comprenne votre activité en 5 secondes.",img:""},practical:{show:!1,title:"Infos Pratiques",locationTitle:"Notre Emplacement",hoursTitle:"Nos Horaires",mapBtnLabel:"Voir l'itinéraire",address:"123 Rue de la Réussite, 75000 Paris",mapsLink:"https://goo.gl/maps/...",displayMode:"text",hoursImg:"",hoursItems:[{label:"Lun - Ven",time:"09:00 - 18:00"},{label:"Samedi",time:"10:00 - 14:00"},{label:"Dimanche",time:"10:00 - 14:00"}]},faq:{show:!0,title:"Questions fréquentes",items:[{q:"Est-ce que cette offre est faite pour moi ?",a:"Explique à qui s’adresse ton service (type de client, situation, besoin principal) et dans quels cas c’est idéal. Tu peux aussi préciser pour qui ce n’est pas forcément adapté."},{q:"Comment se passe la collaboration / la prestation ?",a:"Décris les grandes étapes simplement : premier contact, échange ou diagnostic, réalisation, livraison ou suivi. Rassure sur la clarté et la simplicité du process."},{q:"En combien de temps puis-je avoir des résultats ?",a:"Indique un délai réaliste : mise en place, livraison, premiers effets visibles. Si ça dépend de certains facteurs, précise lesquels sans entrer dans le technique."},{q:"Puis-je adapter ou faire évoluer la prestation plus tard ?",a:"Explique ce qui est modifiable, évolutif ou personnalisable dans le temps, et dans quelles conditions (ajustements, options, accompagnement, etc.)."},{q:"Comment démarrer / prendre contact ?",a:"Explique clairement l’action à faire ensuite : prise de rendez-vous, formulaire, appel, message. Rassure sur le fait que le premier échange est simple et sans engagement."}]},contact:{title:"Parlons de votre projet",desc:"Explique ici comment on te contacte et ce que la personne va obtenir. Dis s’il s’agit d’un appel, d’un mail ou d’un rendez-vous, et à quoi ça sert (questions, devis, projet).En une lecture, on doit savoir ce qui se passe après le clic.",ctaLabel:"Prendre RDV",type:"RDV",value:"https://votre-url-ici"},socials:{title:"Suivez-nous",linkedin:"https://linkedin.com/",facebook:"https://facebook.com/",instagram:"https://instagram.com/"},legal:{editor:"[NOM PRÉNOM]",companyName:"[RAISON SOCIALE]",address:"[ADRESSE COMPLÈTE]",siren:"[VOTRE SIREN]",siret:"[VOTRE SIRET]",contactType:"EMAIL",contactValue:"Y29udGFjdEBkb21haW5lLmNvbQ==",hostMode:"Netlify Inc. 610 22nd Street, San Francisco, CA 94107, USA"},linkedinKit:{bannerTitle:"Explique quelle est ton offre unique et le bénéfice pour tes futurs clients",figures:[{label:"Point clé 1"},{label:"Point clé 2"},{label:"Point clé 3"}],vignette1Title:"Echangeons sur votre projet",vignette1Cta:"Sélectionner",vignette2Title:"Découvrir mon univers",vignette2Cta:"Sélectionner"}};const frame=document.getElementById("preview-frame");let currentActiveSectionId="section-accueil";const STEPS_ORDER=["hero","services","testimonials","social-proof","about","practical","faq","contact","footer"];frame.onload=()=>{sync()};const emailInput=document.getElementById("lead-email"),validateBtn=document.getElementById("lead-email-validate"),iaSection=document.getElementById("section-ia"),iaElements=Array.from(iaSection.querySelector(".space-y-6").children).filter(e=>!e.classList.contains("input-group"));iaElements.forEach(e=>e.style.display="none");let errorMsg=document.createElement("p");errorMsg.className="text-xs text-red-400 mt-1",errorMsg.style.display="none",errorMsg.innerText="Merci de renseigner un email valide.";const inputGroupDiv=emailInput.closest("div.flex");function isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function markButtonValidated(){validateBtn.style.background="#10B981",validateBtn.innerHTML='<span style="color:white; font-weight:bold; font-size:1.2rem;">✓</span>',validateBtn.disabled=!0}inputGroupDiv.insertAdjacentElement("afterend",errorMsg);const storedEmail=localStorage.getItem("lead_email");function sendProgressToNetlify(){const e=localStorage.getItem("lead_email");if(!e)return;const t=localConfig.lastStep||"ia",i=["section-vitrine","section-model","section-couleurs","section-identite","section-ia","section-accueil","section-services","section-avis","section-gallery","section-about","section-practical","section-faq","section-contact","section-social","section-seo","section-legale","section-hebergement","section-linkedin-kit","section-finale"],n=i.indexOf(t),o=-1!==n?Math.round((n+1)/i.length*100):10,a=new FormData;a.append("form-name","lead-vitrine"),a.append("email",e),a.append("status",o>=100?"completed":"in_progress"),a.append("step",t),a.append("progress",o),fetch("/",{method:"POST",body:a})}function applyPracticalDefaults(){localConfig.practical||(localConfig.practical={}),localConfig.practical.locationTitle="Notre Emplacement",localConfig.practical.hoursTitle="Nos Horaires",localConfig.practical.mapBtnLabel="Voir l'itinéraire";const e=["Lun - Ven","Samedi","Dimanche"];localConfig.practical.hoursItems?localConfig.practical.hoursItems.forEach((t,i)=>{e[i]&&(t.label=e[i])}):localConfig.practical.hoursItems=e.map(e=>({label:e,time:""}))}function switchConfigMode(e,t=!1){const i=document.getElementById("preview-placeholder"),n=document.getElementById("preview-wrapper"),o=document.querySelector("main .absolute.top-0");if(!e||""===e){i&&i.classList.remove("hidden"),n&&n.classList.add("opacity-0"),o&&o.classList.add("hidden"),document.querySelectorAll(".mode-web, .mode-linkedin, .mode-core").forEach(e=>e.style.display="none");const e=document.getElementById("section-finale");return void(e&&(e.style.display="none"))}if(localConfig.selectedMode=e,i&&i.classList.add("hidden"),n&&n.classList.remove("opacity-0"),o&&o.classList.remove("hidden"),!t){const e=document.querySelector("#section-vitrine .btn-save-step");e&&!0===localConfig.steps?.["section-vitrine"]&&(localConfig.steps["section-vitrine"]=!1,e.classList.remove("btn-validated-status"),e.innerText="Valider ma vitrine"),localStorage.setItem("vitrine_express_progression",JSON.stringify(localConfig))}const a=document.getElementById("toggle-web-btn"),l=document.getElementById("toggle-li-btn"),s=document.querySelectorAll(".mode-web"),c=document.querySelectorAll(".mode-linkedin"),r=document.querySelectorAll(".mode-core"),d=document.getElementById("container-linkedin-global"),u=document.getElementById("section-finale");s.forEach(e=>e.style.display="none"),c.forEach(e=>e.style.display="none"),r.forEach(e=>e.style.display="none"),d&&(d.style.display="none"),u&&(u.style.display="none"),"web"===e?(r.forEach(e=>e.style.display="block"),s.forEach(e=>e.style.display="block"),u&&(u.style.display="block"),a?.classList.add("hidden"),l?.classList.add("hidden"),switchPreview("web")):"linkedin"===e?(r.forEach(e=>e.style.display="block"),c.forEach(e=>e.style.display="block"),d&&(d.style.display="block"),u&&(u.style.display="block"),a?.classList.add("hidden"),l?.classList.add("hidden"),switchPreview("linkedin")):"full"===e&&(r.forEach(e=>e.style.display="block"),s.forEach(e=>e.style.display="block"),c.forEach(e=>e.style.display="block"),d&&(d.style.display="block"),u&&(u.style.display="block"),a?.classList.remove("hidden"),l?.classList.remove("hidden"),switchPreview("web")),checkGlobalValidation()}function switchPreview(e){const t=document.getElementById("preview-frame"),i=document.getElementById("linkedin-frame"),n=document.getElementById("linkedin-protector"),o=document.getElementById("toggle-web-btn"),a=document.getElementById("toggle-li-btn"),l=["bg-white","shadow-sm","border-slate-200","text-[#8449d9]"],s=["bg-slate-50/50","border-transparent","text-slate-500"];"web"===e?(t.classList.remove("hidden"),i.classList.add("hidden"),n&&n.classList.add("hidden"),o.classList.add(...l),o.classList.remove(...s),a.classList.add(...s),a.classList.remove(...l)):"linkedin"===e&&(t.classList.add("hidden"),i.classList.remove("hidden"),n&&n.classList.remove("hidden"),a.classList.add(...l),a.classList.remove(...s),o.classList.add(...s),o.classList.remove(...l)),localConfig.selectedPreview=e}function sync(){const e=localConfig.selectedMode||"web";frame&&frame.contentWindow&&frame.contentWindow.postMessage({type:"UPDATE_CONFIG",config:localConfig,viewMode:e},"*");const t=document.getElementById("linkedin-frame");if(t&&t.contentWindow){const e=localConfig.linkedinKit||{},i={colors:localConfig.colors,header:localConfig.header,linkedinKit:e,hero:{title:e.bannerTitle,figures:e.figures,showFigures:!1!==localConfig.hero?.showFigures},vignette1Title:e.vignette1Title,vignette1Cta:e.vignette1Cta||"Contact",vignette2Title:e.vignette2Title,vignette2Cta:e.vignette2Cta||"Voir l'offre",contact:{ctaLabel:e.vignette1Cta||"Contact"}};t.contentWindow.postMessage({type:"UPDATE_CONFIG",config:i},"*")}}function processFile(e,t,i=!1){if(!e||!e.type.startsWith("image/"))return;const n=new FileReader;n.onload=e=>{const n=new Image;n.onload=()=>{const e=document.createElement("canvas"),o=i?400:800;let a=n.width,l=n.height;a>o&&(l*=o/a,a=o),e.width=a,e.height=l;e.getContext("2d").drawImage(n,0,0,a,l);const s=e.toDataURL("image/webp",.7);t(s)},n.src=e.target.result},n.readAsDataURL(e)}function handleImage(e,t,i){const n="logo"===i;processFile(e.files[0],e=>{localConfig[t][i]=e,updateImageUI(t,i,e),sync()},n)}function handleDrop(e,t,i){e.preventDefault();if(document.getElementById(`drop-zone-${t}`).classList.remove("bg-slate-100","border-[#8449d9]"),e.dataTransfer.files&&e.dataTransfer.files[0]){const n="logo"===i;processFile(e.dataTransfer.files[0],e=>{localConfig[t][i]=e,updateImageUI(t,i,e),sync()},n)}}function updateImageUI(e,t,i){const n=document.getElementById(`preview-img-${e}`),o=document.getElementById(`upload-placeholder-${e}`),a=document.getElementById(`trash-btn-${e}`),l=document.getElementById(`drop-zone-${e}`);i&&""!==i?(n&&(n.src=i,n.classList.remove("hidden")),o&&o.classList.add("hidden"),a&&a.classList.remove("hidden"),l&&l.classList.add("border-green-400","border-solid")):(n&&(n.src="",n.classList.add("hidden")),o&&o.classList.remove("hidden"),a&&a.classList.add("hidden"),l&&l.classList.remove("border-green-400","border-solid")),"hero"===e&&(checkAccueilValidity(),markSectionDirty("section-accueil","Valider l'accueil")),"header"===e&&"logo"===t&&(checkIdentiteValidity(),markSectionDirty("section-identite","Valider l'identité visuelle"))}function clearImage(e,t){localConfig[e][t]="",updateImageUI(e,t,""),sync()}function validateStep(e){const t=event?event.currentTarget:null;t&&(t.classList.add("btn-validated-status"),t.innerText="✓ Validé");const i=e.replace("#","");localConfig.steps||(localConfig.steps={});const n=t?t.closest("[id]"):null;n&&(localConfig.steps[n.id]=!0),localConfig.lastStep=i,localStorage.setItem("vitrine_express_progression",JSON.stringify(localConfig)),currentActiveSectionId=i;const o=document.getElementById(i);o&&(o.scrollIntoView({behavior:"smooth",block:"start"}),o.classList.add("ring-2","ring-[#8449d9]/30","rounded-2xl"),setTimeout(()=>o.classList.remove("ring-2"),2e3));const a={"section-accueil":"hero","section-services":"services","section-avis":"testimonials","section-gallery":"social-proof","section-about":"about","section-practical":"practical","section-faq":"faq","section-contact":"contact","section-social":"social-links","section-legale":"footer-credit"}[i];a&&frame&&frame.contentWindow&&frame.contentWindow.postMessage({type:"SCROLL_TO",section:a},"*"),updateProgressBar(i),checkGlobalValidation()}function updateProgressBar(e){const t=document.getElementById("progress-fill"),i=document.getElementById("progress-text"),n=["section-vitrine","section-model","section-couleurs","section-identite","section-ia","section-accueil","section-services","section-avis","section-gallery","section-about","section-practical","section-faq","section-contact","section-social","section-seo","section-legale","section-hebergement","section-linkedin-kit","section-finale"],o=n.indexOf(e);let a=0;a=-1!==o?Math.round((o+1)/n.length*100):5,t&&(t.style.width=a+"%",t.style.background=a>=100?"linear-gradient(90deg, #10B981, #059669)":"linear-gradient(90deg, #8449d9, #059669)"),i&&(i.innerText=a+"% configuré")}storedEmail&&isValidEmail(storedEmail)&&(emailInput.value=storedEmail,iaElements.forEach(e=>e.style.display="block"),iaSection.dataset.sent="true",markButtonValidated()),validateBtn.addEventListener("click",()=>{const e=emailInput.value.trim();isValidEmail(e)?(errorMsg.style.display="none",localStorage.setItem("lead_email",e),iaElements.forEach(e=>e.style.display="block"),iaSection.dataset.sent="true",markButtonValidated()):errorMsg.style.display="block"}),window.addEventListener("beforeunload",()=>{sendProgressToNetlify()}),window.onload=()=>{const e=localStorage.getItem("vitrine_express_progression");if(e)try{Object.assign(localConfig,JSON.parse(e)),applyPracticalDefaults();const t=localConfig.meta?.template;if(t){const e=TEMPLATES_DB.find(e=>e.id===t);if(e){const i=document.querySelectorAll(".cat-btn"),n=Array.from(i).find(t=>t.innerText.toUpperCase().includes(e.cat.toUpperCase()));n&&filterTemplates(e.cat,n),adaptUIForTemplate(t),frame.src=`template-${t}.html`;const o=document.getElementById("linkedin-frame");o&&(o.src=`template-linkedin-${t}.html`,o.onload=()=>sync())}}else{const e=document.querySelector(".cat-btn");e&&filterTemplates("Essentiel",e)}if(localConfig.colors&&Object.entries(localConfig.colors).forEach(([e,t])=>{const i=document.getElementById(`cp-${e}`);i&&(i.value=t);const n=document.getElementById(`label-hex-${e}`);n&&(n.innerText=t.toUpperCase());const o=document.getElementById(`pv-${e}`);o&&(o.style.backgroundColor=t)}),localConfig.header){const e=localConfig.header.useTextOnly,t=document.getElementById("no-logo-toggle");t&&(t.checked=e),toggleLogoMode(e);const i=document.getElementById("input-company-name");i&&(i.value=localConfig.header.companyName||"")}const i=document.getElementById("li-show-logo-toggle");if(i&&localConfig.linkedinKit&&(i.checked=!1!==localConfig.linkedinKit.showLogo),localConfig.header?.logo&&updateImageUI("header","logo",localConfig.header.logo),localConfig.hero?.img&&updateImageUI("hero","img",localConfig.hero.img),localConfig.about?.img&&updateImageUI("about","img",localConfig.about.img),localConfig.practical?.hoursImg&&updateImageUI("practical","hoursImg",localConfig.practical.hoursImg),localConfig.gallery?.images?.forEach((e,t)=>{e.src&&updateGalleryImageUI(t,e.src)}),localConfig.practical){const e=localConfig.practical,t=!0===e.show,i=document.getElementById("toggle-practical");i&&(i.checked=t);const n=document.getElementById("practical-info-card"),o=document.getElementById("practical-content");t?(n?.classList.add("hidden"),o?.classList.remove("hidden")):(n?.classList.remove("hidden"),o?.classList.add("hidden"));const a=document.querySelector('input[onchange="updatePracticalCta(this.checked)"]');a&&(a.checked=!1!==e.showMapBtn),setPracticalMode(e.displayMode||"text")}const n=document.getElementById("toggle-figures");n&&(n.checked=!1!==localConfig.hero?.showFigures);const o=document.getElementById("toggle-faq"),a=document.getElementById("faq-editor-content");localConfig.faq||(localConfig.faq={show:!0,title:"Questions fréquentes",items:[]});const l=!1!==localConfig.faq.show;if(o&&(o.checked=l),a&&(a.style.opacity=l?"1":"0.3",a.style.pointerEvents=l?"auto":"none"),localConfig.testimonials){const e=!1!==localConfig.testimonials.show,t=document.getElementById("toggle-testimonials"),i=document.getElementById("testimonials-editor-content");t&&(t.checked=e),i&&(i.style.opacity=e?"1":"0.3",i.style.pointerEvents=e?"auto":"none")}if(localConfig.selectedMode){const e=document.querySelector(`input[name="config-type"][value="${localConfig.selectedMode}"]`);e&&(e.checked=!0)}localConfig.lastStep&&updateProgressBar(localConfig.lastStep),localConfig.steps&&Object.keys(localConfig.steps).forEach(e=>{if(!0===localConfig.steps[e]){const t=document.querySelector(`#${e} .btn-save-step`);t&&(t.classList.add("btn-validated-status"),t.innerText="✓ Validé",t.disabled=!1,t.style.opacity="1",t.style.pointerEvents="auto")}})}catch(e){console.error("Erreur chargement local",e)}else applyPracticalDefaults(),localConfig.services?.items?.forEach(e=>{e.showPrice=!0,e.showPrefix=!0});initPracticalDefaults(),switchConfigMode(localConfig.selectedMode,!0),checkPracticalValidity(),checkAccueilValidity(),checkIdentiteValidity(),checkServicesValidity(),checkTestimonialsValidity(),checkFaqValidity(),checkLegalValidity(),checkLinkedinValidity(),checkGlobalValidation()},document.addEventListener("contextmenu",e=>{if("linkedin"===localConfig.selectedPreview){if(e.target.closest("#preview-wrapper"))return e.preventDefault(),console.log("Protection active : Clic droit bloqué."),!1}}),document.addEventListener("dragstart",e=>{"linkedin"===localConfig.selectedPreview&&e.target.closest("#preview-wrapper")&&e.preventDefault()});const TEMPLATES_DB=[{id:"moderne",name:"Moderne",cat:"Essentiel",hasHeroImg:!0},{id:"zen",name:"Zen",cat:"Sérénité",hasHeroImg:!1},{id:"pop",name:"Pop Art",cat:"Audace",hasHeroImg:!0},{id:"audacieux",name:"Impact",cat:"Audace",hasHeroImg:!1}];function filterTemplates(e,t){document.querySelectorAll(".cat-btn").forEach(e=>{e.classList.remove("active","border-[#8449d9]","bg-violet-50/50")}),t.classList.add("active","border-[#8449d9]","bg-violet-50/50");const i=document.getElementById("grid-templates");if(!i)return;for(;i.firstChild;)i.removeChild(i.firstChild);TEMPLATES_DB.filter(t=>t.cat===e).forEach(e=>{const t=document.createElement("div"),n=localConfig.meta&&localConfig.meta.template===e.id||frame.src.includes(`template-${e.id}.html`);t.className=`model-card ${n?"active border-[#8449d9] ring-1 ring-[#8449d9]":"border-slate-100"} cursor-pointer p-6 rounded-xl border-2 bg-slate-50 hover:border-[#8449d9] transition-all flex items-center justify-center group`,t.onclick=()=>selectModel(e.id,t);const o=document.createElement("p");o.className="font-bold text-xs uppercase tracking-widest text-slate-600 group-[.active]:text-[#8449d9]",o.textContent=e.name,t.appendChild(o),i.appendChild(t)})}function selectModel(e,t){document.querySelectorAll(".model-card").forEach(e=>{e.classList.remove("active","border-[#8449d9]","ring-1","ring-[#8449d9]")}),t.classList.add("active","border-[#8449d9]","ring-1","ring-[#8449d9]"),localConfig.meta||(localConfig.meta={}),localConfig.meta.template=e,adaptUIForTemplate(e),frame.src=`template-${e}.html`,frame.onload=()=>sync();const i=document.getElementById("linkedin-frame");i&&(i.src=`template-linkedin-${e}.html`,i.onload=()=>sync());const n=document.querySelector("#section-model .btn-save-step");n&&!0===localConfig.steps?.["section-model"]&&(localConfig.steps["section-model"]=!1,n.classList.remove("btn-validated-status"),n.innerText="Valider ce modèle")}function updateColorSync(e,t){localConfig.colors[e]=t;const i=document.getElementById(`label-hex-${e}`);i&&(i.textContent=t.toUpperCase());const n=document.getElementById(`pv-${e}`);n&&(n.style.backgroundColor=t),localConfig.steps["section-couleurs"]=!1;const o=document.querySelector("#section-couleurs .btn-save-step");o&&(o.classList.remove("btn-validated-status"),o.innerText="Valider mes couleurs",o.disabled=!1),sync()}function updateText(e,t,i){localConfig[e]||(localConfig[e]="faq"===e||"about"===e?{show:!0}:{}),"header"===e&&"companyName"===t&&(markSectionDirty("section-identite","Valider l'identité visuelle"),checkIdentiteValidity()),localConfig[e][t]=i,"hero"===e&&markSectionDirty("section-accueil","Valider l'accueil"),"services"===e&&(markSectionDirty("section-services","Valider les services"),checkServicesValidity()),"testimonials"===e&&(markSectionDirty("section-avis","Valider les avis"),checkTestimonialsValidity()),"about"===e&&(markSectionDirty("section-about","Valider l'à propos'"),checkAboutValidity()),"practical"===e&&markSectionDirty("section-practical","Valider les infos'"),"faq"===e&&markSectionDirty("section-faq","Valider la faq"),"contact"===e&&(markSectionDirty("section-contact","Valider le contact'"),checkContactValidity()),sync()}function updateServiceCard(e,t,i){localConfig.services&&localConfig.services.items[e]&&(localConfig.services.items[e][t]=i,markSectionDirty("section-services","Valider les services"),checkServicesValidity(),sync())}function toggleLogoMode(e){const t=document.getElementById("container-logo-upload"),i=document.getElementById("container-company-name");localConfig.header.useTextOnly=e,e?(t.classList.add("hidden"),i.classList.remove("hidden")):(t.classList.remove("hidden"),i.classList.add("hidden")),sync()}function updateDynamicFavicon(){const e=document.getElementById("favicon"),t=document.getElementById("favicon-apple"),i=localConfig.colors?.accent||"#1ECAD3",n=localConfig.header?.companyName||"Entreprise",o=localConfig.header?.logo;if(o&&""!==o.trim()&&!localConfig.header.useTextOnly)e&&(e.href=o),t&&(t.href=o);else{const o=document.createElement("canvas");o.width=64,o.height=64;const a=o.getContext("2d");a.fillStyle=i,a.beginPath(),a.arc(32,32,32,0,2*Math.PI),a.fill(),a.fillStyle="#FFFFFF",a.font="bold 38px sans-serif",a.textAlign="center",a.textBaseline="middle",a.fillText(n.charAt(0).toUpperCase(),32,32);const l=o.toDataURL("image/png");e&&(e.href=l),t&&(t.href=l)}}function updateHeroToggle(e,t){localConfig.hero[e]=t;const i=document.getElementById("figures-container");i&&(i.style.opacity=t?"1":"0.4",i.style.pointerEvents=t?"auto":"none"),markSectionDirty("section-accueil","Valider l'accueil"),sync()}function updateFigure(e,t,i){localConfig.hero.figures||(localConfig.hero.figures=[{num:"",label:""},{num:"",label:""},{num:"",label:""}]),localConfig.hero.figures[e]&&(localConfig.hero.figures[e][t]=i),markSectionDirty("section-accueil","Valider l'accueil"),sync()}function handleLabelSelectChange(e,t){const i=document.getElementById(`fig-custom-${e}`);markSectionDirty("section-accueil","Valider l'accueil"),"CUSTOM"===t?i&&i.classList.remove("hidden"):(i&&i.classList.add("hidden"),updateFigure(e,"label",t))}function handleCTASelect(e){const t=document.getElementById("hero-cta-custom");"CUSTOM"===e?t.classList.remove("hidden"):(t.classList.add("hidden"),updateText("hero","ctaLabel",e)),markSectionDirty("section-accueil","Valider l'accueil")}function handleIndicationChange(e,t){const i=document.getElementById(`custom-prefix-${e}`);"Saisie libre"===t?i.classList.remove("hidden"):(i.classList.add("hidden"),i.value="",updateServiceCard(e,"prefix",t))}function toggleServiceFeature(e,t,i){localConfig.services&&localConfig.services.items[e]&&(localConfig.services.items[e][t]=i,markSectionDirty("section-services","Valider les services"),checkServicesValidity(),sync())}function updateServiceCard(e,t,i){localConfig.services&&localConfig.services.items[e]&&(localConfig.services.items[e][t]=i,"price"===t&&""!==i.trim()&&(localConfig.services.items[e].showPrice=!0),"prefix"===t&&""!==i.trim()&&(localConfig.services.items[e].showPrefix=!0),markSectionDirty("section-services","Valider les services"),checkServicesValidity(),sync())}function updateTestimonial(e,t,i){localConfig.testimonials.items[e]||(localConfig.testimonials.items[e]={stars:5,text:"",name:"",role:""}),localConfig.testimonials.items[e][t]="stars"===t?parseInt(i)||5:i,markSectionDirty("section-avis","Valider les avis"),checkTestimonialsValidity(),sync()}function updateGalleryGrid(e){const t=parseInt(e);if(document.querySelectorAll(".gal-item").forEach((e,i)=>{i<t?e.classList.remove("hidden"):e.classList.add("hidden")}),t>localConfig.gallery.images.length)for(let e=localConfig.gallery.images.length;e<t;e++)localConfig.gallery.images.push({src:"",cap:""});else localConfig.gallery.images=localConfig.gallery.images.slice(0,t);markSectionDirty("section-gallery","Valider la galerie"),checkGalleryValidity(),sync()}function handleGalleryImage(e,t){e.files&&e.files[0]&&processGalleryFile(e.files[0],t)}function handleGalleryDrop(e,t){e.preventDefault();const i=document.getElementById(`drop-zone-gal-${t}`);i&&i.classList.remove("border-[#8449d9]","bg-slate-50"),e.dataTransfer.files&&e.dataTransfer.files[0]&&processGalleryFile(e.dataTransfer.files[0],t)}function processGalleryFile(e,t){processFile(e,e=>{localConfig.gallery.images[t]||(localConfig.gallery.images[t]={src:"",cap:""}),localConfig.gallery.images[t].src=e,updateGalleryImageUI(t,e),markSectionDirty("section-gallery","Valider la galerie"),checkGalleryValidity(),sync()})}function updateGalleryImageUI(e,t){const i=document.getElementById(`preview-img-gal-${e}`),n=document.getElementById(`upload-placeholder-gal-${e}`),o=document.getElementById(`trash-btn-gal-${e}`),a=document.getElementById(`drop-zone-gal-${e}`);t&&""!==t?(i&&(i.src=t,i.classList.remove("hidden")),n&&n.classList.add("hidden"),o&&o.classList.remove("hidden"),a&&a.classList.add("border-green-400","border-solid")):(i&&(i.src="",i.classList.add("hidden")),n&&n.classList.remove("hidden"),o&&o.classList.add("hidden"),a&&a.classList.remove("border-green-400","border-solid"))}function clearGalleryImage(e){localConfig.gallery.images[e]&&(localConfig.gallery.images[e].src=""),updateGalleryImageUI(e,""),markSectionDirty("section-gallery","Valider la galerie"),checkGalleryValidity(),sync()}function updateGalleryCaption(e,t){localConfig.gallery.images[e]&&(localConfig.gallery.images[e].cap=t,markSectionDirty("section-gallery","Valider la galerie"),checkGalleryValidity(),sync())}function handleAboutDrop(e){e.preventDefault(),document.getElementById("drop-zone-about")?.classList.remove("border-[#8449d9]","bg-slate-50"),e.dataTransfer.files&&e.dataTransfer.files[0]&&processAboutFile(e.dataTransfer.files[0])}function handleAboutImage(e){e.files&&e.files[0]&&processAboutFile(e.files[0])}function processAboutFile(e){processFile(e,e=>{localConfig.about||(localConfig.about={}),localConfig.about.img=e,updateAboutImageUI(e),markSectionDirty("section-about","Valider l'à propos'"),checkAboutValidity(),sync()})}function updateAboutImageUI(e){const t=document.getElementById("preview-img-about"),i=document.getElementById("upload-placeholder-about"),n=document.getElementById("trash-btn-about");e&&""!==e?(t&&(t.src=e,t.classList.remove("hidden")),i&&i.classList.add("hidden"),n&&n.classList.remove("hidden")):(t&&(t.src="",t.classList.add("hidden")),i&&i.classList.remove("hidden"),n&&n.classList.add("hidden"))}function clearAboutImage(){localConfig.about&&(localConfig.about.img=""),document.getElementById("about-img-upload").value="",updateAboutImageUI(""),markSectionDirty("section-about","Valider l'à propos'"),checkSAboutValidity(),sync()}function handlePracticalImage(e){e.files&&e.files[0]&&processFile(e.files[0],e=>{const t=document.getElementById("preview-img-practical"),i=document.getElementById("upload-placeholder-practical"),n=document.getElementById("trash-btn-practical");t&&(t.src=e,t.classList.remove("hidden")),i&&i.classList.add("hidden"),n&&n.classList.remove("hidden"),localConfig.practical.hoursImg=e,markSectionDirty("section-practical","Valider les infos"),checkPracticalValidity(),sync()})}function handlePracticalDrop(e){if(e.preventDefault(),document.getElementById("drop-zone-practical")?.classList.remove("border-[#8449d9]","bg-slate-50"),e.dataTransfer.files&&e.dataTransfer.files[0]){const t=document.getElementById("hours-img-up"),i=new DataTransfer;i.items.add(e.dataTransfer.files[0]),t&&(t.files=i.files,handlePracticalImage(t))}}function clearPracticalImage(){const e=document.getElementById("preview-img-practical"),t=document.getElementById("upload-placeholder-practical"),i=document.getElementById("trash-btn-practical");e&&(e.src="",e.classList.add("hidden")),t&&t.classList.remove("hidden"),i&&i.classList.add("hidden"),document.getElementById("hours-img-up").value="",localConfig.practical.hoursImg="",markSectionDirty("section-practical","Valider les infos"),checkPracticalValidity(),sync()}const fixedLabels=["Lun - Ven","Samedi","Dimanche"],hoursState=[{open:!0,continuous:!1,mStart:"",mEnd:"",aStart:"",aEnd:"",start:"",end:""},{open:!0,continuous:!1,mStart:"",mEnd:"",aStart:"",aEnd:"",start:"",end:""},{open:!0,continuous:!1,mStart:"",mEnd:"",aStart:"",aEnd:"",start:"",end:""}];function initPracticalDefaults(){localConfig.practical||(localConfig.practical={}),void 0===localConfig.practical.show&&(localConfig.practical.show=!1),localConfig.practical.title="Infos Pratiques",localConfig.practical.locationTitle="Notre Emplacement",localConfig.practical.hoursTitle="Nos Horaires",localConfig.practical.mapBtnLabel="Voir l'itinéraire",localConfig.practical.displayMode=localConfig.practical.displayMode||"text",localConfig.practical.showMapBtn=void 0===localConfig.practical.showMapBtn||localConfig.practical.showMapBtn,localConfig.practical.hoursItems||(localConfig.practical.hoursItems=fixedLabels.map(e=>({label:e,time:"—"})));const e=localConfig.practical.show,t=document.getElementById("toggle-practical");t&&(t.checked=e);const i=document.getElementById("practical-info-card"),n=document.getElementById("practical-content");e?(i?.classList.add("hidden"),n?.classList.remove("hidden")):(i?.classList.remove("hidden"),n?.classList.add("hidden")),"function"==typeof toggleSectionVisibility&&toggleSectionVisibility("practical",e)}function togglePracticalSectionVisibility(e){localConfig.practical.show=e;const t=document.getElementById("practical-info-card"),i=document.getElementById("practical-content");e?(t?.classList.add("hidden"),i?.classList.remove("hidden")):(t?.classList.remove("hidden"),i?.classList.add("hidden")),"function"==typeof toggleSectionVisibility&&toggleSectionVisibility("practical",e),markSectionDirty("section-practical","Valider les infos"),checkPracticalValidity(),sync()}function formatHour(e){let t=e.value.replace(/\D/g,"").slice(0,4);t.length>=3&&(t=t.slice(0,2)+":"+t.slice(2)),e.value=t}function toggleDayOpen(e,t){hoursState[e].open=t;const i=document.querySelector(`.day-block[data-index="${e}"]`);if(!i)return;const n=i.querySelector(".day-split"),o=i.querySelector(".day-continuous"),a=i.querySelector(".day-closed");t?(a?.classList.add("hidden"),hoursState[e].continuous?(o?.classList.remove("hidden"),n?.classList.add("hidden")):(n?.classList.remove("hidden"),o?.classList.add("hidden"))):(n?.classList.add("hidden"),o?.classList.add("hidden"),a?.classList.remove("hidden")),syncHours(e)}function toggleContinuous(e,t){hoursState[e].continuous=t;const i=document.querySelector(`.day-block[data-index="${e}"]`);if(!i)return;const n=i.querySelector(".day-split"),o=i.querySelector(".day-continuous");t?(n?.classList.add("hidden"),o?.classList.remove("hidden")):(n?.classList.remove("hidden"),o?.classList.add("hidden")),syncHours(e)}function updateSplit(e,t,i){hoursState[e][t]=i,syncHours(e)}function updateContinuous(e,t,i){hoursState[e][t]=i,syncHours(e)}function syncHours(e){const t=hoursState[e];let i="Fermé";if(t.open)if(t.continuous)i=t.start&&t.end?`${t.start} - ${t.end}`:"—";else{const e=t.mStart&&t.mEnd?`${t.mStart} - ${t.mEnd}`:"",n=t.aStart&&t.aEnd?`${t.aStart} - ${t.aEnd}`:"";i=e&&n?`${e} / ${n}`:"—"}localConfig.practical.hoursItems[e]={label:fixedLabels[e],time:i},markSectionDirty("section-practical","Valider les infos"),checkPracticalValidity(),sync()}function updateAddressPart(e,t){window.currentAddr||(window.currentAddr={street:"",zip:"",city:""}),window.currentAddr[e]=t;const{street:i,zip:n,city:o}=window.currentAddr;localConfig.practical.address=`${i}, ${n} ${o}`.trim().replace(/^, /,"").replace(/\s+/g," "),markSectionDirty("section-practical","Valider les infos"),checkPracticalValidity(),sync()}function updatePracticalCta(e){localConfig.practical.showMapBtn=e,markSectionDirty("section-practical","Valider les infos"),checkPracticalValidity(),sync()}function setPracticalMode(e){localConfig.practical.displayMode=e;const t=document.getElementById("btn-practical-text"),i=document.getElementById("btn-practical-image"),n=document.getElementById("hours-text-inputs"),o=document.getElementById("hours-image-upload");"text"===e?(t?.classList.add("bg-white","shadow-sm","text-[#8449d9]"),i?.classList.remove("bg-white","shadow-sm","text-[#8449d9]"),n?.classList.remove("hidden"),o?.classList.add("hidden")):(i?.classList.add("bg-white","shadow-sm","text-[#8449d9]"),t?.classList.remove("bg-white","shadow-sm","text-[#8449d9]"),o?.classList.remove("hidden"),n?.classList.add("hidden")),markSectionDirty("section-practical","Valider les infos"),checkPracticalValidity(),sync()}function toggleSectionVisibility(e,t){let i,n,o,a;"avis"===e||"testimonials"===e?(i="testimonials",n="testimonials-editor-content",o="section-avis",a="Valider les avis"):"faq"===e&&(i="faq",n="faq-editor-content",o="section-faq",a="Valider la FAQ"),localConfig[i]||(localConfig[i]={}),localConfig[i].show=t;const l=document.getElementById(n);l&&(l.style.opacity=t?"1":"0.3",l.style.pointerEvents=t?"auto":"none"),t&&localConfig.steps&&(localConfig.steps[o]=!1),markSectionDirty(o,a),"faq"===e?checkFaqValidity():checkTestimonialsValidity(),sync()}function updateFaqDisplayCount(e){const t=parseInt(e);localConfig.faq||(localConfig.faq={show:!0,title:"Questions fréquentes",items:[],displayCount:3}),localConfig.faq.displayCount=t;for(let e=0;e<5;e++){const i=document.getElementById(`faq-item-${e}`);i&&(e<t?i.classList.remove("hidden"):i.classList.add("hidden"))}markSectionDirty("section-faq","Valider la faq"),localConfig.steps&&(localConfig.steps["section-faq"]=!1),checkFaqValidity(),sync()}function updateFAQ(e,t,i){localConfig.faq||(localConfig.faq={show:!0,title:"Questions fréquentes",items:[]}),localConfig.faq.items||(localConfig.faq.items=[]),localConfig.faq.items[e]||(localConfig.faq.items[e]={q:"",a:""}),localConfig.faq.items[e][t]=i,checkFaqValidity(),markSectionDirty("section-faq","Valider la faq"),sync()}const COUNTRY_DATA={FR:{prefix:"+33",label:"Numéro français (+33)",placeholder:"06 12 34 56 78",img:"https://flagcdn.com/w40/fr.png"},BE:{prefix:"+32",label:"Numéro belge (+32)",placeholder:"0470 12 34 56",img:"https://flagcdn.com/w40/be.png"},LU:{prefix:"+352",label:"Numéro luxembourgeois (+352)",placeholder:"621 123 456",img:"https://flagcdn.com/w40/lu.png"}};function updateContactData(e,t){localConfig.contact||(localConfig.contact={}),localConfig.contact[e]=t,"ctaLabel"===e&&(localConfig.header||(localConfig.header={})),checkContactValidity(),markSectionDirty("section-contact","Valider le contact"),sync()}function handleCtaLabelChange(e){const t=document.getElementById("custom-cta-label");"custom"===e?(t.classList.remove("hidden"),updateContactData("ctaLabel",t.value)):(t.classList.add("hidden"),updateContactData("ctaLabel",e))}function toggleFlagDropdown(){document.getElementById("flag-dropdown-list").classList.toggle("hidden")}function handleCountryChange(e){localConfig.contact||(localConfig.contact={});const t=COUNTRY_DATA[e];localConfig.contact.countryPrefix=t.prefix,localConfig.contact.countryIso=e,document.getElementById("selected-flag-img").src=t.img;const i=document.getElementById("label-cta-value"),n=document.getElementById("cta-value-input");"tel"===localConfig.contact.type&&(i.innerText=t.label,n.placeholder=t.placeholder),document.getElementById("flag-dropdown-list").classList.add("hidden"),sync()}function handleCtaTypeChange(e){const t=document.getElementById("cta-value-input"),i=document.getElementById("label-cta-value"),n=document.getElementById("tel-flag-combo");if(localConfig.contact||(localConfig.contact={}),localConfig.contact.type=e,"tel"===e){n.classList.remove("hidden"),t.classList.add("!rounded-l-none");handleCountryChange(localConfig.contact.countryIso||"FR")}else n.classList.add("hidden"),t.classList.remove("!rounded-l-none"),i.innerText="email"===e?"Adresse Email":"Lien du bouton",t.placeholder="email"===e?"contact@exemple.com":"https://...";checkContactValidity(),markSectionDirty("section-contact","Valider le contact"),sync()}function updateMeta(e,t){if(localConfig.meta||(localConfig.meta={}),localConfig.meta[e]=t,"title"===e){const e=document.getElementById("preview-google-title");e&&(e.textContent=t||"Vitrine pop - Votre Nom")}if("description"===e){const e=document.getElementById("preview-google-desc");e&&(e.textContent=t||"La meta description (160 caractères max) sert à donner envie de cliquer sur ton site depuis Google...")}markSectionDirty("section-seo","Valider le seo"),checkMetaValidity(),sync()}window.addEventListener("click",function(e){const t=document.getElementById("tel-flag-combo"),i=document.getElementById("flag-dropdown-list");t&&!t.contains(e.target)&&i?.classList.add("hidden")});const LEGAL_LABELS={FR:{pro:["SIREN","SIRET"],asso:["Numéro RNA","SIREN (facultatif)"]},BE:{pro:["Numéro BCE","TVA (si diff.)"],asso:["Numéro BCE","N° d'unité"]},LU:{pro:["Numéro RCS","Numéro de matricule"],asso:["Numéro RCS","N° d'inscription"]}};let tempSocialLinks={linkedin:"https://linkedin.com/",facebook:"https://facebook.com/",instagram:"https://instagram.com/"},currentLegalCountry="FR",currentEntityType="pro";function updateSocials(e,t){localConfig.socials||(localConfig.socials={}),localConfig.socials[e]=t,"title"!==e&&(tempSocialLinks[e]=t),markSectionDirty("section-social","Valider mes réseaux"),checkSocialsValidity(),sync()}function handleSocialToggle(e,t){localConfig.socials||(localConfig.socials={});const i=document.getElementById(`input-social-${e}`);localConfig.socials[e]=t?i.value||tempSocialLinks[e]||"https://":"",localConfig.socials[e]=t?i.value||"https://":"",markSectionDirty("section-social","Valider mes réseaux"),localConfig.steps&&(localConfig.steps["section-social"]=!1),checkSocialsValidity(),sync()}function handleEntityType(e){localConfig.legal||(localConfig.legal={}),localConfig.legal.entityType=e;const t=document.getElementById("warning-particulier"),i=document.getElementById("legal-fields-container"),n=document.getElementById("btn-validate-legal"),o=document.getElementById("id-company-name");"particulier"===e?(t&&(t.querySelector("p").textContent="La configuration est réservée aux entreprises et associations.",t.classList.remove("hidden")),i&&i.classList.add("hidden"),n&&n.classList.add("hidden")):(t&&t.classList.add("hidden"),i&&i.classList.remove("hidden"),n&&n.classList.remove("hidden"),o&&(o.placeholder="asso"===e?"Nom de l'association":"Raison Sociale"),handleLegalCountryChange(localConfig.legal.country||"FR")),checkLegalValidity()}function handleLegalCountryChange(e){localConfig.legal||(localConfig.legal={}),localConfig.legal.country=e;const t=document.getElementById("legal-flag-img");t&&(t.src=`https://flagcdn.com/w40/${e.toLowerCase()}.png`);const i=document.getElementById("id-1"),n=document.getElementById("id-2"),o=localConfig.legal.entityType||"pro";"FR"===e?(i.placeholder="asso"===o?"N° RNA":"SIRET",n.placeholder="pro"===o?"SIREN":"SIRET (si applicable)"):"BE"===e?(i.placeholder="BCE - N° d'entreprise",n.placeholder="N° de TVA"):"LU"===e&&(i.placeholder="N° RCS",n.placeholder="N° Matricule"),markSectionDirty("section-legale","Valider les informations"),checkLegalValidity(),sync()}function updateLegal(e,t){if(localConfig.legal||(localConfig.legal={firstName:"",lastName:"",companyName:"",address:"",id1:"",id2:"",contactValue:""}),localConfig.legal[e]=t,"email"===e)try{localConfig.legal.contactValue=btoa(t)}catch(e){localConfig.legal.contactValue=t}markSectionDirty("section-legale","Valider les informations"),checkLegalValidity(),sync()}function updateLinkedinKit(e,t){localConfig.linkedinKit||(localConfig.linkedinKit={}),localConfig.linkedinKit[e]=t,checkLinkedinValidity(),markSectionDirty("section-linkedin-kit","Valider mon kit linkedin"),sync()}function updateLinkedinFigure(e,t){localConfig.linkedinKit||(localConfig.linkedinKit={}),localConfig.linkedinKit.figures||(localConfig.linkedinKit.figures=[{label:""},{label:""},{label:""}]),localConfig.linkedinKit.figures[e]={label:t},markSectionDirty("section-linkedin-kit","Valider mon kit linkedin"),checkLinkedinValidity(),sync()}function handleLinkedinCtaChange(e,t){updateLinkedinKit("v1"===e?"vignette1Cta":"vignette2Cta",t),markSectionDirty("section-linkedin-kit","Valider mon kit linkedin"),checkLinkedinValidity(),sync()}function handleLinkedinEntity(e){localConfig.linkedinKit||(localConfig.linkedinKit={}),localConfig.linkedinKit.entityType=e;const t=document.getElementById("warning-linkedin-particulier"),i=document.getElementById("section-linkedin-kit");"particulier"===e?(t&&t.classList.remove("hidden"),i&&i.classList.add("hidden")):(t&&t.classList.add("hidden"),i&&i.classList.remove("hidden")),sync()}function checkSectionValidity(e,t){const i=document.querySelector(`#${e} .btn-save-step`);i&&(t?(i.disabled=!1,i.classList.remove("opacity-50","cursor-not-allowed"),i.style.pointerEvents="auto"):(i.disabled=!0,i.classList.add("opacity-50","cursor-not-allowed"),i.style.pointerEvents="none"))}function markSectionDirty(e,t){const i=document.querySelector(`#${e} .btn-save-step`);i&&(i.classList.remove("btn-validated-status"),i.innerText=t)}function getIdentiteBtn(){return document.querySelector("#section-identite .btn-save-step")}function checkIdentiteValidity(){const e=getIdentiteBtn();if(!e)return;const t=localConfig.header?.useTextOnly,i=!!localConfig.header?.logo,n=(localConfig.header?.companyName||"").trim();let o=!1;t&&n.length>0&&(o=!0),!t&&i&&(o=!0),o?(e.disabled=!1,e.style.opacity="1",e.style.pointerEvents="auto"):(e.disabled=!0,e.style.opacity="0.4",e.style.pointerEvents="none")}function resetIdentiteValidation(){const e=getIdentiteBtn();if(!e)return;const t=localConfig.steps?.header,i=localConfig.header?.dirty;t&&!i?(e.classList.add("btn-validated-status"),e.innerText="✓ Validé"):(e.classList.remove("btn-validated-status"),e.innerText="Valider l'identité visuelle")}function validateIdentite(){localConfig.steps||(localConfig.steps={}),localConfig.steps["section-identite"]=!0,localConfig.header||(localConfig.header={}),localConfig.header.dirty=!1,localStorage.setItem("vitrine_express_progression",JSON.stringify(localConfig)),resetIdentiteValidation()}function adaptUIForTemplate(e){const t=TEMPLATES_DB.find(t=>t.id===e);if(!t)return;const i=document.getElementById("drop-zone-hero")?.closest(".input-group");i&&(t.hasHeroImg?i.classList.remove("hidden"):i.classList.add("hidden")),checkAccueilValidity()}function checkAccueilValidity(){const e=document.querySelector("#section-accueil .btn-save-step");if(!e)return;const t=localConfig.hero||{};if(!0===(localConfig.steps||{})["section-accueil"])return e.disabled=!1,e.classList.add("btn-validated-status"),e.classList.remove("opacity-50","cursor-not-allowed"),e.innerText="✓ Validé",e.style.opacity="1",void(e.style.pointerEvents="auto");const i="Ton titre principal",n="Explique en une phrase ce que tu fais, pour qui, et le bénéfice principal. Simple, concret, sans jargon technique. Si on ne comprend pas en 5 secondes, simplifie.",o=["150+","10","99%"],a=["PROJETS RÉALISÉS","ANNÉES d'EXPERTISE","CLIENTS SATISFAITS"],l=t.title&&""!==t.title.trim()&&t.title!==i,s=t.desc&&""!==t.desc.trim()&&t.desc!==n,c=t.ctaLabel&&""!==t.ctaLabel.trim();let r=!0;const d=document.getElementById("toggle-figures");d&&d.checked&&(r=!(!t.figures||t.figures.length<3)&&t.figures.every((e,t)=>{const i=e.num?e.num.toString().trim():"",n=e.label?e.label.toString().trim():"";return""!==i&&""!==n&&i!==o[t]&&n!==a[t]}));const u=TEMPLATES_DB.find(e=>e.id===localConfig.meta?.template),m=!(!u||u.hasHeroImg)||t.img&&""!==t.img;l&&s&&c&&r&&m?(e.disabled=!1,e.classList.remove("opacity-50","cursor-not-allowed","btn-validated-status"),e.innerText="Valider l'accueil",e.style.opacity="1",e.style.pointerEvents="auto"):(e.disabled=!0,e.classList.add("opacity-50","cursor-not-allowed"),e.classList.remove("btn-validated-status"),e.innerText="Valider l'accueil",e.style.opacity="0.5",e.style.pointerEvents="none")}function resetAccueilValidation(){const e=document.querySelector("#section-accueil .btn-save-step");if(!e)return;const t=localConfig.steps?.["section-accueil"],i=localConfig.hero?.dirty;t&&!i?(e.classList.add("btn-validated-status"),e.classList.remove("bg-[#8449d9]"),e.innerText="✓ Validé"):(e.classList.remove("btn-validated-status"),e.classList.add("bg-[#8449d9]"),e.innerText="Valider laccueil")}function validateHero(){localConfig.steps||(localConfig.steps={}),localConfig.steps["section-accueil"]=!0,localConfig.hero||(localConfig.hero={}),localConfig.hero.dirty=!1,localStorage.setItem("vitrine_express_progression",JSON.stringify(localConfig)),resetAccueilValidation()}const SERVICES_DEFAULTS={title:"Nos solutions",items:[{h3:"Serv 1",p:"Présente ici un service clé ou un bénéfice majeur. Explique ce que tu fais, pour qui, et ce que ça change pour ton client."},{h3:"Serv 2",p:"Présente ici un service clé ou un bénéfice majeur. Explique ce que tu fais, pour qui, et ce que ça change pour ton client."},{h3:"Serv 3",p:"Présente ici un service clé ou un bénéfice majeur. Explique ce que tu fais, pour qui, et ce que ça change pour ton client."}]};function checkServicesValidity(){const e=localConfig.services||{},t=e.items||[];let i=!0;e.title&&""!==e.title.trim()&&e.title!==SERVICES_DEFAULTS.title||(i=!1),t.forEach((e,t)=>{const n=SERVICES_DEFAULTS.items[t];e.h3&&""!==e.h3.trim()&&e.h3!==n.h3&&e.p&&""!==e.p.trim()&&e.p!==n.p||(i=!1),!e.showPrice||e.price&&""!==e.price.trim()||(i=!1),!e.showPrefix||e.prefix&&""!==e.prefix.trim()||(i=!1)}),checkSectionValidity("section-services",i)}const TESTIMONIALS_DEFAULTS={title:"Ce que nos clients disent",ctaText:"Et si vous étiez le prochain ?",items:[{stars:"5",text:"",name:"",role:""},{stars:"5",text:"",name:"",role:""},{stars:"5",text:"",name:"",role:""}]};function checkTestimonialsValidity(){const e=localConfig.testimonials||{},t=e.items||[];if(!1===e.show)return void checkSectionValidity("section-avis",!0);let i=!0;e.title&&""!==e.title.trim()&&e.title!==TESTIMONIALS_DEFAULTS.title||(i=!1),e.ctaText&&""!==e.ctaText.trim()&&e.ctaText!==TESTIMONIALS_DEFAULTS.ctaText||(i=!1),t.forEach(e=>{e.text&&""!==e.text.trim()&&e.name&&""!==e.name.trim()&&e.role&&""!==e.role.trim()||(i=!1)}),checkSectionValidity("section-avis",i)}const GALLERY_DEFAULTS={title:"Des résultats concrets",images:[{src:"",cap:"Témoignage client : [Prénom], [métier/statut] : ‘[Phrase courte sur ce qu’ils ont aimé ou le résultat]"},{src:"",cap:"Projet / réalisation : [Nom du projet] pour [client/secteur] – [bénéfice principal ou usage]"},{src:"",cap:"Bénéfice / avant‑après : [Produit/service réalisé] – aide [client/secteur] à [résultat principal]"}]};function checkGalleryValidity(){const e=localConfig.gallery||{},t=e.images||[];let i=!0;e.title&&""!==e.title.trim()&&e.title!==GALLERY_DEFAULTS.title||(i=!1);for(let e=0;e<t.length;e++){const n=t[e];if(!n||!n.src||""===n.src.trim()||!n.cap||""===n.cap.trim()||GALLERY_DEFAULTS.images[e]&&n.cap.trim()===GALLERY_DEFAULTS.images[e].cap){i=!1;break}}checkSectionValidity("section-gallery",i)}const ABOUT_DEFAULTS={title:"Qui sommes nous",desc:"Racontez en quelques phrases qui vous êtes et ce que vous faites. Vous pouvez : vous présenter individuellement (votre rôle, votre approche, vos forces) ; présenter votre équipe (qui fait quoi, vos expertises) ; ou expliquer votre concept / votre société (mission, valeur ajoutée, bénéfices pour vos clients). Soyez clair, simple et engageant : l’objectif est que quelqu’un comprenne votre activité en 5 secondes.",img:""};function checkAboutValidity(){const e=localConfig.about||{};let t=!0;e.title&&""!==e.title.trim()&&e.title!==ABOUT_DEFAULTS.title||(t=!1),e.desc&&""!==e.desc.trim()&&e.desc!==ABOUT_DEFAULTS.desc||(t=!1),e.img&&""!==e.img.trim()||(t=!1),checkSectionValidity("section-about",t)}function checkPracticalValidity(){const e=localConfig.practical||{};if(!document.querySelector("#section-practical .btn-save-step"))return;if(localConfig.steps&&!0===localConfig.steps["section-practical"])return;if(!1===e.show)return void checkSectionValidity("section-practical",!0);let t=!0;if(e.address&&""!==e.address.trim()&&"123 Rue de la Réussite, 75000 Paris"!==e.address||(t=!1),!1!==e.showMapBtn){const i="https://goo.gl/maps/...";e.mapsLink&&""!==e.mapsLink.trim()&&e.mapsLink!==i||(t=!1)}if("text"===e.displayMode){const i=["09:00 - 18:00","10:00 - 14:00"];if(!e.hoursItems||e.hoursItems.length<3)t=!1;else{e.hoursItems.every(e=>{const t=(e.time||"").trim();return"—"!==t&&""!==t&&!i.includes(t)})||(t=!1)}}else e.hoursImg&&""!==e.hoursImg.trim()||(t=!1);checkSectionValidity("section-practical",t)}function checkFaqValidity(){if(!document.querySelector("#section-faq .btn-save-step"))return;const e=localConfig.faq||{};if(!1===e.show)return void checkSectionValidity("section-faq",!0);if(localConfig.steps&&!0===localConfig.steps["section-faq"])return;const t=["Est-ce que ooooooooooooooooooooooo ?","Comment ooooooooooooooooooooooooooo ?","En combien de temps ooooooooooooooooooooo ?","Puis-je adapter oooooooooooooooooooo ?","Comment ooooooooooooooooooooooooooo ?"],i=["Explique à qui s’adresse ton service (type de client, situation, besoin principal) et dans quels cas c’est idéal. Tu peux aussi préciser pour qui ce n’est pas forcément adapté.","Décris les grandes étapes simplement : premier contact, échange ou diagnostic, réalisation, livraison ou suivi. Rassure sur la clarté et la simplicité du process.","Indique un délai réaliste : mise en place, livraison, premiers effets visibles. Si ça dépend de certains facteurs, précise lesquels sans entrer dans le technique.","Explique ce qui est modifiable, évolutif ou personnalisable dans le temps, et dans quelles conditions (ajustements, options, accompagnement, etc.).","Explique clairement l’action à faire ensuite : prise de rendez-vous, formulaire, appel, message. Rassure sur le fait que le premier échange est simple et sans engagement."];let n=!0;e.title&&""!==e.title.trim()&&"Questions fréquentes"!==e.title||(n=!1);const o=parseInt(e.displayCount||3);for(let a=0;a<o;a++){const o=e.items&&e.items[a]?e.items[a]:null;if(!o||!o.q||!o.a){n=!1;break}const l=o.q.trim(),s=o.a.trim();if(""===l||""===s||l===t[a]||s===i[a]){n=!1;break}}checkSectionValidity("section-faq",n)}function checkContactValidity(){const e=localConfig.contact||{};if(!document.querySelector("#section-contact .btn-save-step"))return;if(localConfig.steps&&!0===localConfig.steps["section-contact"])return;const t="Parlons de votre projet",i="Explique ici comment on te contacte",n="https://votre-url-ici";let o=!0;e.title&&""!==e.title.trim()&&e.title!==t||(o=!1),e.desc&&""!==e.desc.trim()&&!e.desc.includes(i)||(o=!1),e.ctaLabel&&""!==e.ctaLabel.trim()&&"Saisir"!==e.ctaLabel||(o=!1),e.value&&""!==e.value.trim()&&e.value!==n||(o=!1),e.type&&""!==e.type.trim()||(o=!1),checkSectionValidity("section-contact",o)}function checkSocialsValidity(){const e=localConfig.socials||{};if(!document.querySelector("#section-social .btn-save-step"))return;if(localConfig.steps&&!0===localConfig.steps["section-social"])return;const t=document.getElementById("toggle-social-facebook")?.checked,i=document.getElementById("toggle-social-linkedin")?.checked,n=document.getElementById("toggle-social-instagram")?.checked,o="Suivez-nous",a="https://facebook.com/",l="https://linkedin.com/",s="https://instagram.com/";let c=!0;t||i||n?(e.title&&""!==e.title.trim()&&e.title!==o||(c=!1),!t||e.facebook&&""!==e.facebook.trim()&&e.facebook!==a&&"https://"!==e.facebook||(c=!1),!i||e.linkedin&&""!==e.linkedin.trim()&&e.linkedin!==l&&"https://"!==e.linkedin||(c=!1),!n||e.instagram&&""!==e.instagram.trim()&&e.instagram!==s&&"https://"!==e.instagram||(c=!1)):c=!0,checkSectionValidity("section-social",c)}function checkMetaValidity(){const e=localConfig.meta||{};if(!document.querySelector("#section-seo .btn-save-step"))return;if(localConfig.steps&&!0===localConfig.steps["section-seo"])return;let t=!0;e.title&&""!==e.title.trim()&&"Vitrine pop - Votre Nom"!==e.title||(t=!1),e.description&&""!==e.description.trim()&&!e.description.includes("La meta description (160 caractères max)")||(t=!1),checkSectionValidity("section-seo",t)}function checkLegalValidity(){const e=localConfig.legal||{},t=document.querySelector("#section-legale .btn-save-step");if(!t)return;const i=e.firstName&&e.firstName.trim().length>1&&e.lastName&&e.lastName.trim().length>1&&e.companyName&&e.companyName.trim().length>1&&e.address&&e.address.trim().length>5&&e.id1&&e.id1.trim().length>3&&e.contactValue&&e.contactValue.trim().length>5;!i||localConfig.steps&&!0===localConfig.steps["section-legale"]?checkSectionValidity("section-legale",i):(localConfig.steps||(localConfig.steps={}),localConfig.steps["section-legale"]=!0,t.classList.add("btn-validated-status"),t.innerText="✓ Validé",t.disabled=!1,t.style.opacity="1",t.style.pointerEvents="auto",sync())}function checkLinkedinValidity(){const e=localConfig.linkedinKit||{};if(!document.querySelector("#section-linkedin-kit .btn-save-step"))return;const t="Explique quelle est ton offre unique et le bénéfice pour tes futurs clients",i="Echangeons sur votre projet",n="Sélectionner",o="Découvrir mon univers",a="Sélectionner";let l=!0;e.bannerTitle&&""!==e.bannerTitle.trim()&&e.bannerTitle!==t||(l=!1),(!e.figures||e.figures.length<3||!e.figures.every(e=>e.label&&""!==e.label.trim()))&&(l=!1),e.vignette1Title&&""!==e.vignette1Title.trim()&&e.vignette1Title!==i||(l=!1),e.vignette1Cta&&""!==e.vignette1Cta.trim()&&e.vignette1Cta!==n||(l=!1),e.vignette2Title&&""!==e.vignette2Title.trim()&&e.vignette2Title!==o||(l=!1),e.vignette2Cta&&""!==e.vignette2Cta.trim()&&e.vignette2Cta!==a||(l=!1),!l||localConfig.steps&&!0===localConfig.steps["section-linkedin-kit"]?checkSectionValidity("section-linkedin-kit",l):(localConfig.steps||(localConfig.steps={}),localConfig.steps["section-linkedin-kit"]=!0,sync())}function checkGlobalValidation(){const e=localConfig.selectedMode,t=document.getElementById("section-finale"),i=document.getElementById("final-cta-button"),n=document.getElementById("final-cta-text"),o=document.getElementById("final-title"),a=document.getElementById("final-desc");let l=["section-vitrine","section-model","section-couleurs","section-identite"];"web"===e?(l=l.concat(["section-accueil","section-services","section-avis","section-gallery","section-about","section-practical","section-faq","section-contact","section-social","section-seo","section-legale"]),n.innerText="Mettre ma vitrine en ligne"):"linkedin"===e?(l.push("section-linkedin-kit"),n.innerText="Télécharger mon kit LinkedIn"):"full"===e&&(l=l.concat(["section-accueil","section-services","section-avis","section-gallery","section-about","section-practical","section-faq","section-contact","section-social","section-seo","section-legale","section-linkedin-kit"]),n.innerText="Lancer ma présence en ligne");l.every(e=>localConfig.steps&&!0===localConfig.steps[e])?(t.classList.remove("opacity-50","pointer-events-none","border-slate-200"),t.classList.add("border-violet-400","shadow-2xl","shadow-violet-100"),i.classList.remove("grayscale","cursor-not-allowed"),i.classList.add("hover:scale-[1.02]"),o.innerText="Tout est prêt !",o.classList.replace("text-slate-400","text-slate-800"),a.innerText="Vérifie une dernière fois ta vitrine, puis valide ci-dessous pour la rendre visible à tous.",a.classList.replace("text-slate-400","text-slate-500")):(t.classList.add("opacity-50","pointer-events-none"),i.classList.add("grayscale","cursor-not-allowed"),o.innerText="Configuration incomplète")}const PROMPTS={hero:'Tu es un expert en copywriting web orienté conversion et clarté.\n        Tu écris pour un site vitrine professionnel simple, crédible et efficace.\n        CONTEXTE DU SITE\n        - Domaine d’activité : [ex : coach sportif, artisan couvreur, thérapeute, consultant, etc.]\n        - Cible principale : [ex : particuliers, TPE, indépendants, entreprises locales…]\n        - Offres principales : [liste courte de ce que je propose]\n        - Bénéfices clients clés : [ex : gain de temps, tranquillité d’esprit, plus de clients, résultats concrets…]\n        - Action attendue sur le site : contacter / prendre rendez-vous\n        - Ton souhaité : clair, humain, professionnel, sans jargon marketing\n        OBJECTIF\n        Générer le contenu de la section HERO d’un site vitrine optimisé pour inciter à la prise de contact.\n        À PRODUIRE :\n        1️⃣ Un titre H1\n        - Court (1 phrase max)\n        - Orienté bénéfice client\n        - Clair en moins de 5 secondes\n        - Doit expliquer la valeur apportée, pas juste le métier\n        2️⃣ Un paragraphe d’accroche (2–3 lignes max)\n        - Complète le H1 sans le répéter\n        - Précise pour qui c’est, le problème résolu et le résultat attendu\n        - Ton rassurant et concret\n        3️⃣ Des suggestions de chiffres clés pertinents à afficher\n        - Proposer 3 à 5 types de chiffres adaptés à mon activité\n        - Exemples possibles : années d’expérience, projets réalisés, clients accompagnés, délais moyens, taux de satisfaction, zone géographique couverte, spécialisation, etc.\n        - Ne pas inventer de chiffres, seulement indiquer les types à afficher\n        4️⃣ L’intitulé du CTA principal pour passer à la section suivante (bénéfices / services)\n        - Choisir le plus pertinent parmi cette liste :\n        - "Voir nos services"\n        - "Découvrir l’offre"\n        - "Voir les bénéfices"\n        - "Découvrir notre solution"\n        - OU proposer un meilleur intitulé si aucun n’est optimal\n        - Le CTA doit inciter à continuer la lecture, pas vendre directement\n        5️⃣ Une **recommandation de type d’image pour la hero**\n        - Indiquer le type d’image le plus crédible pour mon activité :\n        - photo de réalisations / chantiers\n        - ambiance de travail\n        - photo d’équipe ou du professionnel\n        - illustration sobre\n        - Expliquer brièvement pourquoi ce choix inspire confiance\n        CONTRAINTES\n        - Texte orienté bénéfices clients et confiance\n        - Pas de promesses exagérées\n        - Pas de jargon marketing\n        - Clarté > créativité\n        - Le site doit donner envie de contacter ou prendre rendez-vous\n        Réponds de façon structurée et directement exploitable pour un site web.\n        ',services:"Tu es un expert en rédaction web orientée conversion et clarté.\n        Objectif :\n        M’aider à remplir la section “Services / Bénéfices” de mon site vitrine.\n        Cette section contient 3 cartes visibles en un coup d’œil.\n        Le but est que mes visiteurs comprennent immédiatement :\n        - ce que je propose\n        - en quoi ça les aide concrètement\n        - pourquoi me choisir moi\n        et qu’ils aient envie de cliquer sur “Contacter” ou “Prendre rendez-vous”.\n        Contexte :\n        Mon site est simple, rapide et orienté prise de contact.\n        Les textes doivent être :\n        - clairs\n        - concrets\n        - orientés bénéfices clients\n        - rassurants (confiance, expertise)\n        - sans jargon inutile\n        Tu peux choisir la structure la plus pertinente selon mon activité :\n        - soit 3 services distincts\n        - soit 1 service décliné en 3 bénéfices forts\n        - soit un mix logique (service + bénéfice)\n        L’important : 3 cartes impactantes et cohérentes.\n        Pour chaque carte, fournis :\n        1. Un titre court et explicite (max 5–7 mots)\n        2. Un paragraphe de 2–3 phrases qui parle du problème du client, du bénéfice obtenu et de ce qui me différencie\n        3. (Optionnel) Une suggestion de tarif à afficher ou une recommandation de ne pas afficher de prix si ce n’est pas pertinent\n        Voici les informations à prendre en compte :\n        - Mon activité / métier : [décris ton activité en une phrase simple]\n        - Mes offres ou prestations principales : [liste ou description courte]\n        - Les problèmes ou frustrations de mes clients idéaux : [ce qu’ils veulent éviter]\n        - Les résultats ou bénéfices qu’ils recherchent : [ce qu’ils veulent obtenir]\n        - Ce qui me différencie des autres : [approche, méthode, expérience, valeurs]\n        - Type de client idéal : [freelance, particulier, TPE, PME, etc.]\n        - Souhait d’afficher des tarifs : [oui / non / à recommander]\n        Contraintes importantes :\n        - Le visiteur doit se reconnaître en moins de 5 secondes\n        - Chaque carte doit donner envie d’aller plus loin\n        - Les textes doivent naturellement mener à une prise de contact ou un rendez-vous\n        - Ton style doit être simple, humain et orienté action\n        À la fin, indique :\n        - si la structure choisie est “3 services”, “3 bénéfices” ou “mix”\n        - pourquoi cette structure est la plus pertinente pour mon activité\n        "};function openIAModal(e="hero"){const t=document.getElementById("modal-ia"),i=document.getElementById("prompt-content");t&&i&&PROMPTS[e]&&(t.classList.remove("hidden"),i.innerText=PROMPTS[e])}function closeIAModal(){const e=document.getElementById("modal-ia");e&&e.classList.add("hidden")}function copyAIPrompt(){const e=document.getElementById("prompt-content");if(e){const t=e.innerText;navigator.clipboard.writeText(t).then(()=>{alert("Prompt copié !"),closeIAModal()}).catch(e=>{console.error("Erreur lors de la copie : ",e)})}}let isMobileView=!1;function toggleMobile(){const e=document.getElementById("preview-wrapper"),t=document.getElementById("toggle-text"),i=document.getElementById("preview-frame"),n=document.getElementById("linkedin-frame");isMobileView=!isMobileView,isMobileView?(e.style.setProperty("width","375px","important"),e.style.setProperty("height","700px","important"),e.style.setProperty("padding-top","0","important"),e.classList.add("shadow-2xl","border-[12px]","border-slate-800","rounded-[3rem]","my-auto","overflow-hidden"),[i,n].forEach(e=>{e&&e.classList.add("rounded-[2rem]")}),t.textContent="Vue Desktop"):(e.style.width="100%",e.style.height="100%",e.style.setProperty("padding-top","3.5rem","important"),e.classList.remove("border-[12px]","border-slate-800","rounded-[3rem]","h-[700px]","my-auto","overflow-hidden"),[i,n].forEach(e=>{e&&e.classList.remove("rounded-[2rem]")}),t.textContent="Vue Mobile")}let isFullPreviewOpen=!1;function handleMobilePreview(){const e=document.querySelector("main"),t=document.getElementById("preview-wrapper"),i=document.getElementById("mobile-toggle-icon");if(isFullPreviewOpen=!isFullPreviewOpen,isFullPreviewOpen){if(e.style.setProperty("display","flex","important"),e.className="fixed inset-0 z-[9999] bg-white flex flex-col",t.className="relative w-full h-full pt-20 transition-all",t.style.width="100vw",t.style.height="100vh",i.innerHTML='\n            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path d="M6 18L18 6M6 6l12 12" stroke-width="2" stroke-linecap="round"/>\n            </svg>\n        ',currentActiveSectionId&&frame&&frame.contentWindow){const e=scrollMapping[currentActiveSectionId];frame.contentWindow.postMessage({type:"SCROLL_TO",section:e},"*")}}else e.style.display="",e.className="hidden lg:flex flex-1 bg-slate-100 items-center justify-center relative overflow-hidden",t.className="w-full h-full flex items-center justify-center pt-14 transition-all duration-500",t.style.width="",t.style.height="",i.innerHTML='\n            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>\n                <path d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n            </svg>\n        ';setTimeout(initScrollObserver,300)}const scrollContainer=document.querySelector("aside"),scrollMapping={"section-accueil":"hero","section-services":"services","section-avis":"testimonials","section-gallery":"social-proof","section-about":"about","section-practical":"practical","section-faq":"faq","section-contact":"contact","section-social":"social-links","section-legale":"footer-credit"},scrollObserver=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target.id,i=scrollMapping[t];i&&currentActiveSectionId!==t&&(currentActiveSectionId=t,frame&&frame.contentWindow&&frame.contentWindow.postMessage({type:"SCROLL_TO",section:i},"*"))}})},{root:scrollContainer,threshold:0,rootMargin:"-20% 0px -60% 0px"});function initScrollObserver(){document.querySelectorAll('[id^="section-"]').forEach(e=>{scrollObserver.unobserve(e),scrollObserver.observe(e)})}function generateExport(){localStorage.setItem("vitrine_express_progression",JSON.stringify(localConfig)),alert("Progrès sauvegardés !")}initScrollObserver();